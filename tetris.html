<html>
  <head>
    <link rel="stylesheet" href="css/web_arcade.css">

    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script type="text/javascript" src="js/crafty.js"></script>
    <script>
      $(document).ready(function() {
        var frame_width = 600;
        var frame_height = 800;
        Crafty.init(frame_width, frame_height, document.getElementById('game'));

        //  on a grid of tiles
        Crafty.c('Grid', {
            init: function() {
                this.attr({
                    w: Game.map_grid.tile.width,
                    h: Game.map_grid.tile.height
                });
            },

            // Locate this entity at the given position on the grid
            at: function(x, y) {
                if (x === undefined && y === undefined) {
                    return { x: this.x/Game.map_grid.tile.width, y: this.y/Game.map_grid.tile.height };
                } else {
                    this.attr({ x: x * Game.map_grid.tile.width, y: y * Game.map_grid.tile.height });
                    return this;
                }
            }
        });

        Crafty.c("platform", {
            init: function() {
                this.addComponent('2D, DOM, Color, Solid')
                .color('#000000');
            },

            attribute: function(x_pos, y_pos, width, height) {
                this.attr({x: x_pos, y: y_pos, w: width, h: height});
            }
        });

        Crafty.c("player", {
            init: function() {
                this.addComponent('2D, DOM, Color, Collision, Solid, Gravity, Fourway')
                .color('#49b112')
                .requires('Keyboard')
                .origin('center')
                .fourway(12)
                .gravity('Solid')
                .gravityConst(.5);
            },

            attribute: function(width, height) {
                this.attr({x: frame_width/2, y: frame_height - height, w: width, h: height});
            }
        });

        Crafty.c("goomba", {
            init: function() {
                this.requires('2D, DOM, Color, Collision, Solid, Gravity, spr_player, SpriteAnimation')
                    .attr({x: 10, y: frame_height * 2/5, w: 25, h: 25})
                    .color('#76390c')
                    .gravity('Solid')
                    .gravityConst(.5)
                    .reel('movingRight', 600, 0, 1, 3);

                var animation_speed = 4;
                this.bind('NewDirection', function(data) {
                    this.animate('movingRight', -1);
                })
            }
        });

        //floor
        Crafty.e("platform").attribute(0, frame_height-20, frame_width, 20);
        //middle left
        Crafty.e("platform").attribute(frame_width * 2/3, frame_height * 4/5, frame_width/3, 20);
        //middle right
        Crafty.e("platform").attribute(0,frame_height * 4/5, frame_width/3, 20);
        //middle
        Crafty.e("platform").attribute(frame_width * 1/6, frame_height * 3/5, frame_width * 2/3, 20)
        //top left
        Crafty.e("platform").attribute(frame_width * 2/3, frame_height * 2/5, frame_width/3, 20);
        //top right
        Crafty.e("platform").attribute(0, frame_height * 2/5, frame_width/3, 20);

        //player
        Crafty.e("player").attribute(40, 55);
        Crafty.e("goomba");
      })
    </script>
  </head>
  <body>
    <div id="game" class="content"></div>
  </body>
</html>
